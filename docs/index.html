<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="color-scheme" content="light dark" />
  <title>Tap-n-Score™</title>

  <style>
    :root { --pad: 18px; --card: 18px; }
    body { margin: 0; font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial; }
    .wrap { max-width: 1040px; margin: 0 auto; padding: var(--pad); }
    h1 { margin: 0 0 6px; font-size: 44px; letter-spacing: -0.5px; }
    .sub { margin: 0 0 18px; opacity: .75; font-size: 16px; }
    .card { border: 1px solid rgba(0,0,0,.12); border-radius: var(--card); padding: 18px; }
    .row { display: flex; gap: 12px; align-items: center; flex-wrap: wrap; }
    .row + .row { margin-top: 12px; }

    button {
      font-size: 20px;
      padding: 14px 18px;
      border-radius: 14px;
      border: 1px solid rgba(0,0,0,.2);
      background: rgba(0,0,0,.03);
      cursor: pointer;
    }
    button:active { transform: translateY(1px); }

    .pill {
      font-size: 16px;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,.18);
      background: rgba(0,0,0,.02);
      display: inline-flex;
      gap: 8px;
      align-items: center;
    }

    input[type="number"]{
      font-size: 16px;
      padding: 10px 10px;
      border-radius: 12px;
      border: 1px solid rgba(0,0,0,.22);
      background: rgba(0,0,0,.02);
      width: 110px;
    }
    label { font-size: 14px; opacity: .75; display: block; margin-bottom: 6px; }
    .field { display: inline-block; }

    #statusLine { margin-top: 12px; font-weight: 800; }
    .hint { margin-top: 6px; opacity: .7; font-size: 14px; line-height: 1.35; }

    #targetWrap { margin-top: 14px; }
    .stage {
      position: relative;
      width: 100%;
      display: none;
      border-radius: 16px;
      border: 1px dashed rgba(0,0,0,.25);
      background: rgba(0,0,0,.02);
      overflow: hidden;
      touch-action: manipulation;
    }
    #targetImg {
      width: 100%;
      height: auto;
      display: block;
      user-select: none;
      -webkit-user-drag: none;
    }

    /* tap layer sits on top of the image */
    #tapLayer {
      position: absolute;
      inset: 0;
      cursor: crosshair;
      touch-action: manipulation;
    }

    .dot {
      position: absolute;
      width: 18px;
      height: 18px;
      border-radius: 999px;
      transform: translate(-50%, -50%);
      box-shadow: 0 10px 25px rgba(0,0,0,.25);
      border: 3px solid rgba(255,255,255,.85);
      pointer-events: none;
    }
    .dot.shot { background: rgba(255,60,60,.92); }
    .dot.bull { background: rgba(30,120,255,.92); }

    pre {
      margin-top: 12px;
      padding: 12px;
      border-radius: 14px;
      border: 1px solid rgba(0,0,0,.12);
      background: rgba(0,0,0,.03);
      overflow: auto;
      font-size: 13px;
      line-height: 1.35;
      white-space: pre-wrap;
      word-break: break-word;
    }

    .hiddenInput { position: absolute; left: -9999px; width: 1px; height: 1px; opacity: 0; }
  </style>
</head>

<body>
  <div class="wrap">
    <h1>Tap-n-Score™</h1>
    <p class="sub">iPad/iOS-safe photo picker + tap capture + POST /api/calc (MEAN POIB)</p>

    <div class="card">
      <div class="row">
        <button id="chooseBtn" type="button">Choose Photo</button>
        <button id="clearBtn" type="button">Clear</button>
        <button id="resultsBtn" type="button" disabled>Show Results</button>

        <span class="pill" id="bullPill">Bull: <b>not set</b></span>
        <span class="pill" id="shotsPill">Shots: <b>0</b></span>
      </div>

      <div class="row">
        <div class="field">
          <label for="distanceYds">Distance (yds)</label>
          <input id="distanceYds" type="number" inputmode="decimal" value="100" min="1" step="1" />
        </div>

        <div class="field">
          <label for="moaPerClick">MOA / click</label>
          <input id="moaPerClick" type="number" inputmode="decimal" value="0.25" min="0.01" step="0.01" />
        </div>

        <div class="field">
          <label for="gridAcross">Grid squares across</label>
          <input id="gridAcross" type="number" inputmode="decimal" value="23" min="1" step="1" />
        </div>

        <div class="field">
          <label for="inPerSquare">Inches / square</label>
          <input id="inPerSquare" type="number" inputmode="decimal" value="1" min="0.1" step="0.1" />
        </div>
      </div>

      <input id="photoInput" class="hiddenInput" type="file" accept="image/*" />

      <div id="statusLine">Loading…</div>
      <div class="hint" id="hintLine">
        If “Loading…” never changes, Safari cached an old JS file. Bump the <b>v=</b> below.
      </div>

      <div id="targetWrap">
        <div class="stage" id="stage">
          <img id="targetImg" alt="Selected photo preview" />
          <div id="tapLayer" aria-label="tap layer"></div>
        </div>
      </div>

      <pre id="outBox" style="display:none;"></pre>
    </div>
  </div>

  <!-- IMPORTANT: bump the v= anytime iOS seems cached -->
  <script defer src="./index.js?v=20260201_frontend_mean_calc_2"></script>
</body>
</html>
